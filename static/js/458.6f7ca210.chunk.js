"use strict";(self.webpackChunkmidispatcher=self.webpackChunkmidispatcher||[]).push([[458],{73458:function(e,n,t){t.r(n),t.d(n,{OscillatorMachine:function(){return S}});var i,a,l,r,o,s,u,d,c,f,p,h,v=t(30168),g=t(1413),x=t(70885),m=t(15671),j=t(43144),y=t(60136),b=t(27277),w=t(7894),Z=t(47313),O=t(47616),k=t(22089),C=t(46417),S=(0,k.xc)((a=function(e){(0,y.Z)(t,e);var n=(0,b.Z)(t);function t(e){var i;return(0,m.Z)(this,t),(i=n.call(this)).oscillators={},i.audioContext=void 0,i.mainGainNode=void 0,i.filter=void 0,i.state=void 0,i.turnedOff=!1,i.audioContext=new AudioContext,i.mainGainNode=i.audioContext.createGain(),i.mainGainNode.connect(i.audioContext.destination),i.state=null!==e&&void 0!==e?e:{volume:.1,waveform:"square",detune:0,filter:"lowpass",filterFrequency:5e3,filterQ:1,filterGain:0},i.mainGainNode.gain.value=i.state.volume/4,i.filter=i.audioContext.createBiquadFilter(),i.applyFilterOptions(i.state),i.filter.connect(i.mainGainNode),i.getNode().addMachineInPort("In",1),i}return(0,j.Z)(t,[{key:"getFactory",value:function(){return t.factory}},{key:"applyFilterOptions",value:function(e){this.filter.type=e.filter,this.filter.frequency.value=e.filterFrequency,this.filter.Q.value=e.filterQ,this.filter.gain.value=e.filterGain}},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(e){this.mainGainNode.gain.value=e.volume/4,this.applyFilterOptions(e),this.state.detune!==e.detune&&this.stopAllOscillators(),this.state=e}},{key:"stopAllOscillators",value:function(e){Object.values(this.oscillators).forEach((function(e){e.stop(),e.disconnect()})),!0===e&&(this.turnedOff=!0)}},{key:"receive",value:function(e,n,t){if(!this.turnedOff){var i=e.message.rawData[1]+this.state.detune;if("stop"===e.message.type)this.stopAllOscillators();else if("noteoff"===e.message.type||"noteon"===e.message.type&&0===e.message.rawData[2]){var a,l;null===(a=this.oscillators[i])||void 0===a||a.stop(),null===(l=this.oscillators[i])||void 0===l||l.disconnect(),t.setSending(!0)}else if("noteon"===e.message.type){var r,o,s=this.audioContext.createOscillator();s.connect(this.filter),s.connect(this.mainGainNode),s.frequency.value=function(e){M[e]||(M[e]=440*Math.pow(2,(e-69)/12));return M[e]}(i),s.type=this.state.waveform,null===(r=this.oscillators[i])||void 0===r||r.stop(),null===(o=this.oscillators[i])||void 0===o||o.disconnect(),this.oscillators[i]=s,this.oscillators[i].start(),t.setSending(!0)}}}},{key:"getInChannelCount",value:function(){return 1}}],[{key:"buildFactory",value:function(){return this.factory||(this.factory={createMachine:function(e){return new t(e)},createWidget:function(e,n){return(0,C.jsx)(F,{engine:e,size:50,node:n,machine:n.machine})},getName:function(){return"OscillatorMachine"},getType:function(){return k.Ax.Output},getTooltip:function(){return"Reads MIDI notes and emits sound with basic filtering ability"},getMachineCode:function(){return"oscillator"}}),this.factory}}]),t}(k.Vs),a.factory=void 0,i=a))||i,F=function(e){var n=Z.useState(e.node.machine.getState()),t=(0,x.Z)(n,2),i=t[0],a=t[1];function l(n){e.machine.setState(n),a(n)}function r(n){e.node.setLocked(!n)}var o=(0,k.mV)(e.machine.filter),s=(0,x.Z)(o,2),u=s[0],d=s[1];return(0,C.jsxs)(p.Body,{"data-default-node-name":e.node.getOptions().name,selected:e.node.isSelected(),background:e.node.getOptions().color,children:[(0,C.jsx)(p.Title,{children:(0,C.jsx)(p.TitleName,{children:e.node.getOptions().name})}),(0,C.jsx)(p.Ports,{children:(0,C.jsx)(p.PortsContainer,{children:e.node.getInPorts().map((function(n){return(0,C.jsx)(O.kL,{engine:e.engine,port:n},n.getID())}))})}),(0,C.jsxs)(p.SettingsBar,{children:[(0,C.jsx)("div",{ref:u}),(0,C.jsx)("div",{ref:d}),(0,C.jsxs)(p.Dropdown,{children:[(0,C.jsx)("span",{children:"Waveform: "}),(0,C.jsxs)("select",{name:"waveform",value:i.waveform,onChange:function(e){l((0,g.Z)((0,g.Z)({},i),{},{waveform:e.target.value}))},children:[(0,C.jsx)("option",{value:"sine",children:"Sine"}),(0,C.jsx)("option",{value:"square",children:"Square"}),(0,C.jsx)("option",{value:"sawtooth",children:"Sawtooth"}),(0,C.jsx)("option",{value:"triangle",children:"Triangle"})]})]}),(0,C.jsxs)(p.Slider,{children:[(0,C.jsx)("span",{children:"Volume: "}),(0,C.jsx)("input",{onMouseOver:function(e){return r(!1)},onMouseOut:function(e){return r(!0)},type:"range",min:"0.0",max:"0.5",step:"0.01",value:i.volume,onChange:function(e){l((0,g.Z)((0,g.Z)({},i),{},{volume:Number(e.target.value)}))},list:"volumes",name:"volume"}),(0,C.jsxs)("datalist",{id:"volumes",children:[(0,C.jsx)("option",{value:"0.0",label:"Mute"}),(0,C.jsx)("option",{value:"1.0",label:"100%"})]})]}),(0,C.jsxs)(p.Slider,{children:[(0,C.jsxs)("span",{children:["Detune (",i.detune,")"]}),(0,C.jsx)("input",{onMouseOver:function(e){return r(!1)},onMouseOut:function(e){return r(!0)},type:"range",min:"-12.0",max:"12.0",step:"1",value:i.detune,onChange:function(e){l((0,g.Z)((0,g.Z)({},i),{},{detune:Number(e.target.value)}))},list:"detunes",name:"detune"}),(0,C.jsxs)("datalist",{id:"detunes",children:[(0,C.jsx)("option",{value:"-12.0",label:"-1 octave"}),(0,C.jsx)("option",{value:"0",label:"Normal"}),(0,C.jsx)("option",{value:"12.0",label:"+1 octave"})]})]}),(0,C.jsxs)(p.Dropdown,{children:[(0,C.jsx)("span",{children:"Filter: "}),(0,C.jsxs)("select",{name:"waveform",value:i.filter,onChange:function(e){l((0,g.Z)((0,g.Z)({},i),{},{filter:e.target.value}))},children:[(0,C.jsx)("option",{value:"lowpass",children:"Lowpass"}),(0,C.jsx)("option",{value:"highpass",children:"Highpass"}),(0,C.jsx)("option",{value:"bandpass",children:"Bandpass"}),(0,C.jsx)("option",{value:"peaking",children:"Peaking"}),(0,C.jsx)("option",{value:"notch",children:"Notch"})]})]}),(0,C.jsxs)(p.Slider,{children:[(0,C.jsx)("span",{children:"Filter Freq: "}),(0,C.jsx)("input",{onMouseOver:function(e){return r(!1)},onMouseOut:function(e){return r(!0)},type:"range",min:"500",max:"5000",step:"1",value:i.filterFrequency,onChange:function(e){l((0,g.Z)((0,g.Z)({},i),{},{filterFrequency:Number(e.target.value)}))},list:"filterFrequencies",name:"filterFrequency"}),(0,C.jsx)("datalist",{id:"filterFrequencies",children:(0,C.jsx)("option",{value:"5000",label:"Default"})})]}),(0,C.jsxs)(p.Slider,{children:[(0,C.jsx)("span",{children:"Filter Q: "}),(0,C.jsx)("input",{onMouseOver:function(e){return r(!1)},onMouseOut:function(e){return r(!0)},type:"range",min:"1",max:"50",step:"1",value:i.filterQ,onChange:function(e){l((0,g.Z)((0,g.Z)({},i),{},{filterQ:Number(e.target.value)}))},list:"filterQs",name:"filterQ"}),(0,C.jsx)("datalist",{id:"filterQs",children:(0,C.jsx)("option",{value:"1",label:"Default"})})]}),(0,C.jsxs)(p.Slider,{children:[(0,C.jsx)("span",{children:"Filter Gain: "}),(0,C.jsx)("input",{onMouseOver:function(e){return r(!1)},onMouseOut:function(e){return r(!0)},type:"range",min:"-40",max:"40",disabled:"lowshelf"!==i.filter&&"highshelf"!==i.filter&&"peaking"!==i.filter,step:"1",value:i.filterGain,onChange:function(e){l((0,g.Z)((0,g.Z)({},i),{},{filterGain:Number(e.target.value)}))},list:"filterGains",name:"filterGain"}),(0,C.jsx)("datalist",{id:"filterGains",children:(0,C.jsx)("option",{value:"0",label:"Default"})})]})]})]})};(h=p||(p={})).Dropdown=w.default.div(l||(l=(0,v.Z)(["\n        vertical-align: middle;\n        span {\n\n            vertical-align: middle;\n        }\n        input {\n\n            vertical-align: middle;\n        }\n    "]))),h.Slider=w.default.div(r||(r=(0,v.Z)(["\n        vertical-align: middle;\n        input {\n\n            vertical-align: middle;\n        }\n        span {\n\n            vertical-align: middle;\n        }\n    "]))),h.SettingsBar=w.default.div(o||(o=(0,v.Z)(["\n        padding: 3px;\n        position: relative;\n        vertical-align: middle;\n        width: 100%;\n        display: flex;\n        flex-direction: column;\n    "]))),h.Title=w.default.div(s||(s=(0,v.Z)(["\n        background: rgba(0, 0, 0, 0.3);\n        display: flex;\n        white-space: nowrap;\n        justify-items: center;\n    "]))),h.TitleName=w.default.div(u||(u=(0,v.Z)(["\n        flex-grow: 1;\n        padding: 5px 5px;\n    "]))),h.Ports=w.default.div(d||(d=(0,v.Z)(["\n        display: flex;\n        background-image: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2));\n    "]))),h.PortsContainer=w.default.div(c||(c=(0,v.Z)(["\n        flex-grow: 1;\n        display: flex;\n        flex-direction: column;\n        &:first-of-type {\n\n            margin-right: 10px;\n        }\n        &:only-child {\n\n            margin-right: 0px;\n        }\n    "]))),h.Body=w.default.div(f||(f=(0,v.Z)(["\n        background-color: ",";\n        border-radius: 5px;\n        font-family: sans-serif;\n        color: white;\n        border: solid 2px black;\n        overflow: visible;\n        font-size: 11px;\n        border: solid 2px ",";\n\n    * {\n\n        box-sizing:border-box\n    }"])),(function(e){return e.background}),(function(e){return e.selected?"rgb(0,192,255)":"black"}));var M={}}}]);