"use strict";(self.webpackChunkmidispatcher=self.webpackChunkmidispatcher||[]).push([[805],{66805:function(e,t,n){n.r(t),n.d(t,{NoteGrowMachine:function(){return N},NoteRoundRobinMachine:function(){return j}});var i,o,s,r,a,c,d,u,h,l,f,g,v=n(30168),p=n(15671),m=n(43144),y=n(60136),x=n(27277),w=n(22089),V=n(7894),b=n(89209),k=n(47616),P=n(46417),N=(0,w.xc)((o=function(e){(0,y.Z)(n,e);var t=(0,x.Z)(n);function n(e){var i;(0,p.Z)(this,n),(i=t.call(this)).activeVoices=void 0,i.usedVoices=void 0,i.voices=void 0,i.voices=null!==e&&void 0!==e?e:Number(window.prompt("How many voices?","8")),i.usedVoices=new Array(i.voices),i.getNode().addMachineOutPort(b.UL,0);for(var o=0;o<i.voices;o++)i.getNode().addMachineOutPort("Channel "+(o+1),o+1);return i.getNode().addMachineInPort("In",1),i.activeVoices={},i}return(0,m.Z)(n,[{key:"getFactory",value:function(){return n.factory}},{key:"getState",value:function(){return this.voices}},{key:"receive",value:function(e,t,n){if("noteoff"===e.message.type||"noteon"===e.message.type&&0===e.message.rawData[2]){n.setSending(!0);var i=this.activeVoices[e.message.rawData[1]],o=null===i||void 0===i?void 0:i.pop();void 0!=o&&(this.emit(e,o+1),0==i.length&&delete this.activeVoices[e.message.rawData[1]],this.usedVoices[o]=!1)}else if("noteon"===e.message.type){n.setSending(!0);for(var s=0,r=!1,a=0;a<this.voices;a++)if(!this.usedVoices[a]){s=a,r=!0;break}r||(s=this.voices-1),this.usedVoices[s]=!0,void 0==this.activeVoices[e.message.rawData[1]]&&(this.activeVoices[e.message.rawData[1]]=[]),this.activeVoices[e.message.rawData[1]].push(s),this.emit(e,s+1)}else{if("stop"===e.message.type){for(var c=0;c<this.voices;c++)this.usedVoices[c]=!1;for(var d in this.activeVoices)delete this.activeVoices[d]}for(var u=0;u<this.voices;u++)this.emit(e,u+1)}}}],[{key:"buildFactory",value:function(){return this.factory||(this.factory={createMachine:function(e){return new n(e)},createWidget:function(e,t){return(0,P.jsx)(M,{engine:e,size:50,node:t,machine:t.machine})},getType:function(){return w.Ax.Processor},getName:function(){return"NoteGrowMachine"},getTooltip:function(){return"Reads notes then dispatches them over N voices using the first free voice"},getMachineCode:function(){return"grow"}}),this.factory}}]),n}(w.Vs),o.factory=void 0,i=o))||i,j=(0,w.xc)((r=function(e){(0,y.Z)(n,e);var t=(0,x.Z)(n);function n(e){var i;(0,p.Z)(this,n),(i=t.call(this)).activeVoices=void 0,i.voices=void 0,i.currentVoice=void 0,i.voices=null!==e&&void 0!==e?e:Number(window.prompt("How many voices?","8")),i.getNode().addMachineOutPort(b.UL,0);for(var o=0;o<i.voices;o++)i.getNode().addMachineOutPort("Channel "+(o+1),o+1);return i.getNode().addMachineInPort("In",1),i.currentVoice=0,i.activeVoices={},i}return(0,m.Z)(n,[{key:"getFactory",value:function(){return n.factory}},{key:"getState",value:function(){return this.voices}},{key:"receive",value:function(e,t,n){if("noteoff"===e.message.type||"noteon"===e.message.type&&0===e.message.rawData[2])n.setSending(!0),void 0!=this.activeVoices[e.message.rawData[1]]&&this.emit(e,this.activeVoices[e.message.rawData[1]]+1);else if("noteon"===e.message.type)n.setSending(!0),this.activeVoices[e.message.rawData[1]]=this.currentVoice,this.emit(e,this.currentVoice+1),this.currentVoice=(this.currentVoice+1)%this.voices;else{if("start"===e.message.type||"stop"===e.message.type)for(var i in this.currentVoice=0,this.activeVoices)delete this.activeVoices[i];for(var o=0;o<this.voices;o++)this.emit(e,o+1)}}}],[{key:"buildFactory",value:function(){return this.factory||(this.factory={createMachine:function(e){return new n(e)},createWidget:function(e,t){return(0,P.jsx)(Z,{engine:e,size:50,node:t,machine:t.machine})},getType:function(){return w.Ax.Processor},getName:function(){return"NoteRoundRobinMachine"},getTooltip:function(){return"Reads notes then dispatches them over N voices to allow dispatching to different targets (you can achieve polyphony with multiple monophonic devices this way)"},getMachineCode:function(){return"roundrobin"}}),this.factory}}]),n}(w.Vs),r.factory=void 0,s=r))||s,M=function(e){function t(t){return(0,P.jsx)(k.kL,{engine:e.engine,port:t},t.getID())}return(0,P.jsxs)(f.Body,{"data-default-node-name":e.node.getOptions().name,selected:e.node.isSelected(),background:e.node.getOptions().color,children:[(0,P.jsx)(f.Title,{children:(0,P.jsx)(f.TitleName,{children:e.node.getOptions().name})}),(0,P.jsxs)(f.Ports,{children:[(0,P.jsx)(f.PortsContainer,{children:e.node.getInPorts().map(t)}),(0,P.jsx)(f.PortsContainer,{children:e.node.getOutPorts().map(t)})]})]})},Z=function(e){function t(t){return(0,P.jsx)(k.kL,{engine:e.engine,port:t},t.getID())}return(0,P.jsxs)(f.Body,{"data-default-node-name":e.node.getOptions().name,selected:e.node.isSelected(),background:e.node.getOptions().color,children:[(0,P.jsx)(f.Title,{children:(0,P.jsx)(f.TitleName,{children:e.node.getOptions().name})}),(0,P.jsxs)(f.Ports,{children:[(0,P.jsx)(f.PortsContainer,{children:e.node.getInPorts().map(t)}),(0,P.jsx)(f.PortsContainer,{children:e.node.getOutPorts().map(t)})]})]})};(g=f||(f={})).SettingsBar=V.default.div(a||(a=(0,v.Z)(['\n        padding: 3px;\n        position: relative;\n        vertical-align: middle;\n        width: 100%;\n        display: flex;\n        justifyContent: "center";\n        flex-direction: column;\n    ']))),g.Title=V.default.div(c||(c=(0,v.Z)(["\n        background: rgba(0, 0, 0, 0.3);\n        display: flex;\n        white-space: nowrap;\n        justify-items: center;\n    "]))),g.TitleName=V.default.div(d||(d=(0,v.Z)(["\n        flex-grow: 1;\n        padding: 5px 5px;\n    "]))),g.Ports=V.default.div(u||(u=(0,v.Z)(["\n        display: flex;\n        background-image: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2));\n    "]))),g.PortsContainer=V.default.div(h||(h=(0,v.Z)(["\n        flex-grow: 1;\n        display: flex;\n        flex-direction: column;\n        &:first-of-type {\n\n            margin-right: 10px;\n        }\n        &:only-child {\n\n            margin-right: 0px;\n        }\n    "]))),g.Body=V.default.div(l||(l=(0,v.Z)(["\n        background-color: ",";\n        border-radius: 5px;\n        font-family: sans-serif;\n        color: white;\n        border: solid 2px black;\n        overflow: visible;\n        font-size: 11px;\n        border: solid 2px ",";\n\n    * {\n\n        box-sizing:border-box\n    }"])),(function(e){return e.background}),(function(e){return e.selected?"rgb(0,192,255)":"black"}))}}]);